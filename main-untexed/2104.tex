1 \leq f_i \leq m
