1 \leq p_i, q_i \leq n
