0 \leq c_i, d_i \leq n - 1
